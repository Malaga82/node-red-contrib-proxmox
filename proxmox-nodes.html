<script type="text/x-red" data-template-name="proxmox-nodes">
<div class="form-row">
	<label for="node-input-server"><i class="icon-tag"></i> Proxmox Server</label>
	<input type="text" id="node-input-server" placeholder="Server">
</div>
<div class="form-row">
	<label for="node-input-name"><i class="icon-tag"></i> Name</label>
	<input type="text" id="node-input-name" placeholder="Name">
</div>
<div class="form-row">
	<label for="node-input-node"><i class="icon-tag"></i> Node name</label>
	<input type="text" id="node-input-node" placeholder="Node name">
</div>
<div class="form-row">
	<label for="node-input-method"><i class="fa fa-tasks"></i> Method</label>
	<select type="text" id="node-input-method" style="width:70%;">
		<option value="apt">apt</option>
		<option value="ceph">ceph</option>
		<option value="disks">disks</option>
		<option value="firewall">firewall</option>
		<option value="lxc">lxc</option>
		<option value="network">network</option>
		<option value="qemu">qemu</option>
		<option value="scan">scan</option>
		<option value="services">services</option>
		<option value="storage">storage</option>
		<option value="tasks">tasks</option>
		<option value="vzdump">vzdump</option>
		<option value="aplinfo">aplinfo</option>
		<option value="dns">dns</option>
		<option value="execute">execute</option>
		<option value="migrateall">migrateall</option>
		<option value="netstat">netstat</option>
		<option value="report">report</option>
		<option value="rrd">rrd</option>
		<option value="rrddata">rrddata</option>
		<option value="spiceshell">spiceshell</option>
		<option value="startall">startall</option>
		<option value="status">status</option>
		<option value="stopall">stopall</option>
		<option value="subscription">subscription</option>
		<option value="syslog">syslog</option>
		<option value="time">time</option>
		<option value="version">version</option>
		<option value="vncshell">vncshell</option>
		<option value="vncwebsocket">vncwebsocket</option>
	</select>
</div>
<div class="form-row node-input-id2-row">
	<label for="node-input-id2"><i class="icon-tag"></i> Id</label>
	<input type="text" id="node-input-id2" placeholder="Id">
</div>
</script>

<script type="text/x-red" data-help-name="proxmox-nodes">
<p>This is a node to get information about Proxmox nodes</p>
<p>If no node name is set, this will retrieve a summary list of all the nodes.</p>

<p>If a node name is set, a list of methods will be retrieved for the node</p>
<p><code>msg.proxmox-node</code> value will be used for the node property if it is available.</p>

<p>If a node method is set, detailed informamtion will be retrieved for that detail</p>
<p><code>msg.proxmox-node-method</code> value will be used for the method property if it is available.</p>

<p>See the <a href="https://pve.proxmox.com/pve-docs/api-viewer/index.html">Proxmox API Documentation</a> for further details.</p>
<p>Proxmox version 4.4</p>
</script>

<script type="text/javascript">
RED.nodes.registerType('proxmox-nodes',{
	category: 'proxmox',
	color: '#a6bbcf',
	defaults: {
		name: {value:""},
		node: {value:""},
		id2: {value:""},
		method: {value:"status"},
		server: {value:"", type:"proxmox-server"},
	},
	inputs:1,
	outputs:1,
	icon: "white-globe.png",
	label: function() {
		return this.name||"proxmox-nodes";
	},
	oneditprepare: function() {
		
			$("#node-input-method").change(function() {
			if (["apt", "ceph", "disks", "firewall", "lxc", "network", "qemu", "scan", "services", "storage", "tasks", "vzdump"].includes($(this).val())) {
				$(".node-input-id2-row").show();
			} else {
				$(".node-input-id2-row").hide();
				$('#node-input-id2').val('');
			}
		});
	}
});
</script>
